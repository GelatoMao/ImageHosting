{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","ImageShow","styled","div","H1","h1","Image","img","ComponentUploader","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","window","test","type","size","error","upload","then","console","log","catch","tip","spinning","isLoading","className","InboxOutlined","title","bordered","Item","label","span","target","href","filename","src","alt","ref","onChange","current","value","placeholder","fullStr","Tips","ComponentTips","children","Home","Uploader"],"mappings":"kkBAQQA,EAAYC,IAAZD,QAEFE,EAAYC,IAAOC,IAAV,KAMTC,EAAKF,IAAOG,GAAV,KAKFC,EAAQJ,IAAOK,IAAV,KAqGIC,EAjGWC,aAAS,WAAO,IAAD,EAELC,cAA1BC,EAF+B,EAE/BA,WAAYC,EAFmB,EAEnBA,UACdC,EAAOC,mBACPC,EAAOD,mBAEPE,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,SAFiC,SAExBD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE7CE,OAAQ,KACRC,UATiC,SASvBD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAqBJ,EAAMI,QAAW,IAE/C,cACE,OAAOT,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAYpGC,EAAQ,CAEZC,gBAAgB,EAChBC,aAAc,SAAAC,GAGZ,OAFAnB,EAAWoB,QAAQD,GACnBnB,EAAWqB,YAAYF,EAAKG,MACE,OAA1BrB,EAAUsB,aACZC,IAAQC,QAAQ,qDACT,IAETC,OAAOP,KAAOA,EACT,wCAAwCQ,KAAKR,EAAKS,MAInDT,EAAKU,KAAO,SACdL,IAAQM,MAAM,2CACP,IAET9B,EAAW+B,SAASC,MAAK,SAACrB,GACxBsB,QAAQC,IAAI,4BACZD,QAAQC,IAAIvB,MACXwB,OAAM,WACPF,QAAQC,IAAI,gCAEP,IAbLV,IAAQM,MAAM,+EACP,MAgBb,OACE,gCACE,cAAC,IAAD,CAAMM,IAAI,qBAAMC,SAAUrC,EAAWsC,UAArC,SACE,eAAClD,EAAD,2BAAa4B,GAAb,cACE,mBAAGuB,UAAU,uBAAb,SACE,cAACC,EAAA,EAAD,MAEF,mBAAGD,UAAU,kBAAb,0EACA,mBAAGA,UAAU,kBAAb,wHAMFvC,EAAWW,WAAa,eAACrB,EAAD,WACtB,cAACG,EAAD,uCACA,eAAC,IAAD,CAAcgD,MAAM,mDAAWC,UAAQ,EAAvC,UACE,cAAC,IAAaC,KAAd,CAAmBC,MAAM,2BAAOC,KAAM,EAAtC,SAAyC,mBAAGC,OAAO,SAASC,KAAM/C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAzE,SAA+Eb,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,QACxK,cAAC,IAAa8B,KAAd,CAAmBC,MAAM,qBAAMC,KAAM,EAArC,SAAyC7C,EAAWgD,WACpD,cAAC,IAAaL,KAAd,CAAmBC,MAAM,2BAAOC,KAAM,EAAtC,SAAyC,cAAClD,EAAD,CAAOsD,IAAKjD,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAKqC,IAAI,OAC9G,eAAC,IAAaP,KAAd,CAAmBC,MAAM,2BAAOC,KAAM,EAAtC,UACE,uBAAOM,IAAKjD,EAAMkD,SA1DN,WACtB/C,EAAMG,SAASN,EAAKmD,QAAQC,QAyD2BC,YAAY,2CACzD,uBAAOJ,IAAK/C,EAAMgD,SAvDL,WACvB/C,EAAMK,UAAUN,EAAKiD,QAAQC,QAsD2BC,YAAY,8CAE5D,cAAC,IAAaZ,KAAd,CAAmBC,MAAM,yDAAYC,KAAM,EAA3C,SACE,mBAAGC,OAAO,SAASC,KAAM1C,EAAMmD,QAASN,IAAI,GAA5C,SAAgD7C,EAAMmD,kBAG7C,W,0KC/GvB,IAAMC,EAAOlE,IAAOC,IAAV,KAmBKkE,EAXO5D,aAAS,YAAmB,IAAhB6D,EAAe,EAAfA,SACxB1D,EAAcF,cAAdE,UACR,OACE,mCAEIA,EAAUsB,YAAc,KAAO,cAACkC,EAAD,UAAOE,SCbxCC,EAAO9D,aAAS,WACpB,OACE,qCACE,cAAC,EAAD,yDACA,cAAC+D,EAAD,UAKSD","file":"static/js/10.349e4ac9.chunk.js","sourcesContent":["import React, { useRef } from 'react'\nimport { observer, useLocalStore } from 'mobx-react'\nimport { useStores } from '../stores'\nimport { message, Upload, Descriptions, Spin } from 'antd'\nimport { InboxOutlined } from '@ant-design/icons'\nimport styled from 'styled-components'\n\n\nconst { Dragger } = Upload\n\nconst ImageShow = styled.div`\n  margin-top: 30px;\n  border: 1px dashed #ccc;\n  padding: 20px;\n`\n\nconst H1 = styled.h1`\n  margin: 20px 0;\n  text-align: center;\n`\n\nconst Image = styled.img`\n  max-width: 300px;\n`\n\nconst ComponentUploader = observer(() => {\n\n  const { ImageStore, UserStore } = useStores()\n  const ref1 = useRef()\n  const ref2 = useRef()\n\n  const store = useLocalStore(() => ({\n    width: null,\n    setWidth(width) {\n      store.width = width\n    },\n    get widthStr() {\n      return store.width ? `/w/${store.width}` : ''\n    },\n    height: null,\n    setHeight(height) {\n      store.height = height\n    },\n    get heightStr() {\n      return store.height ? `/h/${store.height}` : ''\n    },\n    get fullStr() {\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\n    }\n  }))\n\n  const bindWidthChange = () => {\n    store.setWidth(ref1.current.value)\n  }\n\n  const bindHeightChange = () => {\n    store.setHeight(ref2.current.value)\n  }\n\n  const props = {\n    // 不显示列表\n    showUploadList: false,\n    beforeUpload: file => {\n      ImageStore.setFile(file)\n      ImageStore.setFilename(file.name)\n      if (UserStore.currentUser === null) {\n        message.warning('请先登录再上传！')\n        return false\n      }\n      window.file = file\n      if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)) {\n        message.error('只能上传svg/png/jpg/jpeg/gif格式的图片')\n        return false\n      }\n      if (file.size > 1024 * 1024) {\n        message.error('图片最大只能1M')\n        return false\n      }\n      ImageStore.upload().then((serverFile) => {\n        console.log('上传成功')\n        console.log(serverFile)\n      }).catch(() => {\n        console.log('上传失败')\n      })\n      return false\n    }\n  }\n\n  return (\n    <div>\n      <Spin tip=\"上传中\" spinning={ImageStore.isLoading}>\n        <Dragger {...props}>\n          <p className=\"ant-upload-drag-icon\">\n            <InboxOutlined />\n          </p>\n          <p className=\"ant-upload-text\">点击或者拖拽上传图片</p>\n          <p className=\"ant-upload-hint\">\n            仅支持.svg/.png/.jpg/.jpeg/.gif格式的图片 图片最大1M\n        </p>\n        </Dragger>\n      </Spin>\n      {\n        ImageStore.serverFile ? <ImageShow>\n          <H1>上传结果</H1>\n          <Descriptions title=\"上传图片信息展示\" bordered>\n            <Descriptions.Item label=\"线上地址\" span={3}><a target=\"_blank\" href={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}</a></Descriptions.Item>\n            <Descriptions.Item label=\"文件名\" span={3}>{ImageStore.filename}</Descriptions.Item>\n            <Descriptions.Item label=\"图片预览\" span={3}><Image src={ImageStore.serverFile.attributes.url.attributes.url} alt=\"\" /></Descriptions.Item>\n            <Descriptions.Item label=\"更多尺寸\" span={3}>\n              <input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度(可选)\" />\n              <input ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度(可选)\" />\n            </Descriptions.Item>\n            <Descriptions.Item label=\"设置大小后线上地址\" span={3}>\n              <a target=\"_blank\" href={store.fullStr} alt=\"\">{store.fullStr}</a>\n            </Descriptions.Item>\n          </Descriptions>\n        </ImageShow> : null\n      }\n    </div >\n  )\n})\n\nexport default ComponentUploader","import React from 'react'\nimport { useStores } from '../stores'\nimport { observer } from 'mobx-react'\nimport styled from 'styled-components'\n\nconst Tips = styled.div`\n  background: orange;\n  padding: 10px;\n  margin: 30px 0;\n  color: #fff;\n  border-radius: 5px;\n`\n\nconst ComponentTips = observer(({ children }) => {\n  const { UserStore } = useStores()\n  return (\n    <>\n      {\n        UserStore.currentUser ? null : <Tips>{children}</Tips>\n      }\n    </>\n  )\n})\n\nexport default ComponentTips","import React from 'react'\nimport { observer } from 'mobx-react'\nimport Uploader from '../components/Uploader'\nimport Tips from '../components/Tips'\n\nconst Home = observer(() => {\n  return (\n    <>\n      <Tips>请先登录再上传</Tips>\n      <Uploader />\n    </>\n  )\n})\n\nexport default Home"],"sourceRoot":""}